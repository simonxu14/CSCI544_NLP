It will be for others to dissect this one, to offer their opinions on what Rowling should or should not have done in terms of plot.  I would suggest--gently, as Dumbledore would have done, I think--that we are somewhat arrogant if we presume to tell her how the characters of her own creation should or should not behave.  Throughout the series, Rowling has proven to be consistent--true to the personalities of her characters, never resorting to trite manipulation, always offering her readers a valid rationale for why characters did what they did.  I spent the weekend reading this last book in the series.  My children--who now have their own children--called to ask:  "Well...?"  "Read it," I told them, "You will not be disappointed."